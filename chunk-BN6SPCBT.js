import{a as P}from"./chunk-SMMVKXXX.js";import{b as L,d as U}from"./chunk-CZLGUVAL.js";import{a as V}from"./chunk-MUJBVTFU.js";import{a as M}from"./chunk-2H4XP5XP.js";import{a as p,j as y,p as x,r as E,u as T}from"./chunk-6F3JZZEN.js";import{$ as k,D as s,Db as b,F as _,G as f,Ja as C,R as w,U as o,ka as m,la as c,pa as g,qa as a,ra as u,sa as v,wa as S,xa as h,ya as d}from"./chunk-QGRJSNEC.js";function q(t,n){if(t&1&&v(0,"img",3),t&2){let l=d();g("src",l.logo,w)}}function I(t,n){t&1&&v(0,"icon-spider")}function B(t,n){if(t&1){let l=S();a(0,"span",8),h("click",function(){_(l);let i=d();return f(i.userService.setMode("dark"))}),C(1," dark_mode "),u()}}function D(t,n){if(t&1){let l=S();a(0,"span",8),h("click",function(){_(l);let i=d();return f(i.userService.setMode())}),C(1," light_mode "),u()}}var Q=(()=>{let n=class n{constructor(){this.userService=s(V),this.ui=s(T),this._alert=s(y),this._http=s(x),this._hash=s(E),this._router=s(b),this._form=s(U),this._translate=s(M),this.logo=p.sign.logo,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:p.sign.email,password:p.sign.password,resetPin:null},this._set=e=>{if(e){let i=e.token||"";i&&this._http.set("token",i),localStorage.setItem("waw_user",JSON.stringify(e)),this.userService.setUser(e),this.userService.get(),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,e=>{e.email&&e.pass?this.login():e.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,e=>{e?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=k({type:n,selectors:[["ng-component"]],decls:10,vars:6,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img",3,"click"],["alt","Logo",3,"src"],[1,"auth__form"],[1,"auth"],[1,"material-icons","auth__icon"],[3,"wSubmit","submition","config"],[1,"material-icons","auth__icon",3,"click"]],template:function(i,r){i&1&&(a(0,"div",0)(1,"div",1)(2,"div",2),h("click",function(){return r.userService.setMode(r.userService.mode?"":"dark")}),m(3,q,1,1,"img",3),m(4,I,1,0,"icon-spider"),u(),a(5,"div",4)(6,"div",5),m(7,B,2,0,"span",6),m(8,D,2,0,"span",6),a(9,"wform",7),h("wSubmit",function(){return r.submit()}),u()()()()()),i&2&&(o(3),c(r.logo?3:-1),o(),c(r.logo?-1:4),o(3),c(r.userService.mode?-1:7),o(),c(r.userService.mode?8:-1),o(),g("submition",r.user)("config",r.form))},dependencies:[P,L],encapsulation:2});let t=n;return t})();export{Q as a};
