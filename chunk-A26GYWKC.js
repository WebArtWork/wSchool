import{a as We}from"./chunk-CZLGUVAL.js";import{a as ke,p as Fe,s as Ve,t as Be}from"./chunk-6F3JZZEN.js";import{$ as W,A as ue,Ab as Te,Bb as He,Ca as te,D as B,Da as ie,Ea as re,F as m,G as g,Ga as D,Ha as G,Ja as L,Ka as be,M as N,R as P,S as xe,U as C,Z as T,a as A,aa as _e,b as ge,cb as Se,db as Re,ea as K,f as b,fa as z,ga as Ce,ib as Ie,ja as ee,ka as U,kb as ze,la as Q,lb as Oe,ma as Me,na as we,oa as ye,ob as Ee,pa as S,q as j,qa as d,r as Z,ra as f,sa as w,ta as ve,u as de,ua as Ae,w as fe,wa as H,xa as x,ya as l,z as V}from"./chunk-QGRJSNEC.js";var Ne=["wrapper"],Ke=["sourceImage"];function Ge(n,s){if(n&1){let e=H();d(0,"img",5,1),x("load",function(){m(e);let i=l();return g(i.imageLoadedInView())})("mousedown",function(i){m(e);let r=l();return g(r.startMove(i,r.moveTypes.Drag))})("touchstart",function(i){m(e);let r=l();return g(r.startMove(i,r.moveTypes.Drag))})("error",function(i){m(e);let r=l();return g(r.loadImageError(i))}),f()}if(n&2){let e=l();D("visibility",e.imageVisible?"visible":"hidden")("transform",e.safeTransformStyle),G("ngx-ic-draggable",!e.disabled&&e.allowMoveImage),S("src",e.safeImgDataUrl,P),ee("alt",e.imageAltText)}}function $e(n,s){if(n&1){let e=H();ve(0),d(1,"span",9),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"topleft"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"topleft"))}),w(2,"span",10),f(),d(3,"span",11),w(4,"span",10),f(),d(5,"span",12),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"topright"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"topright"))}),w(6,"span",10),f(),d(7,"span",13),w(8,"span",10),f(),d(9,"span",14),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottomright"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottomright"))}),w(10,"span",10),f(),d(11,"span",15),w(12,"span",10),f(),d(13,"span",16),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottomleft"))}),w(14,"span",10),f(),d(15,"span",17),w(16,"span",10),f(),d(17,"span",18),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"top"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"top"))}),f(),d(18,"span",19),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"right"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"right"))}),f(),d(19,"span",20),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottom"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"bottom"))}),f(),d(20,"span",21),x("mousedown",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"left"))})("touchstart",function(i){m(e);let r=l(2);return g(r.startMove(i,r.moveTypes.Resize,"left"))}),f(),Ae()}}function Je(n,s){if(n&1){let e=H();d(0,"div",6),x("keydown",function(i){m(e);let r=l();return g(r.keyboardAccess(i))}),d(1,"div",7),x("mousedown",function(i){m(e);let r=l();return g(r.startMove(i,r.moveTypes.Move))})("touchstart",function(i){m(e);let r=l();return g(r.startMove(i,r.moveTypes.Move))}),f(),K(2,$e,21,0,"ng-container",8),f()}if(n&2){let e=l();D("top",e.cropper.y1,"px")("left",e.cropper.x1,"px")("width",e.cropper.x2-e.cropper.x1,"px")("height",e.cropper.y2-e.cropper.y1,"px")("margin-left",e.alignImage==="center"?e.marginLeft:null)("visibility",e.imageVisible?"visible":"hidden"),G("ngx-ic-round",e.roundCropper),ee("aria-label",e.cropperFrameAriaLabel),C(2),S("ngIf",!e.hideResizeSquares)}}var ae=class{constructor(){this.format="png",this.output="blob",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperFrameAriaLabel="Crop photo",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(s){Object.keys(s).filter(e=>e in this).forEach(e=>this[e]=s[e]),this.validateOptions()}setOptionsFromChanges(s){Object.keys(s).filter(e=>e in this).forEach(e=>this[e]=s[e].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}},y=function(n){return n.Drag="drag",n.Move="move",n.Resize="resize",n.Pinch="pinch",n}(y||{});function Ze(n){switch(n){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";case"ArrowLeft":default:return"left"}}function et(n){switch(n){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";case"ArrowLeft":default:return"right"}}function tt(n,s){switch(n){case"ArrowUp":return{clientX:0,clientY:s*-1};case"ArrowRight":return{clientX:s,clientY:0};case"ArrowDown":return{clientX:0,clientY:s};case"ArrowLeft":default:return{clientX:s*-1,clientY:0}}}function it(n,s,e){let t=n.width,i=n.height;s=Math.round(s),e=Math.round(e);let r=t/s,a=i/e,o=Math.ceil(r/2),c=Math.ceil(a/2),p=n.getContext("2d");if(p){let h=p.getImageData(0,0,t,i),u=p.createImageData(s,e),_=h.data,I=u.data;for(let O=0;O<e;O++)for(let E=0;E<s;E++){let R=(E+O*s)*4,v=O*a,M=0,Y=0,oe=0,se=0,ce=0,he=0,le=0,Pe=Math.floor(E*r),Ye=Math.floor(O*a),$=Math.ceil((E+1)*r),J=Math.ceil((O+1)*a);$=Math.min($,t),J=Math.min(J,i);for(let X=Ye;X<J;X++){let pe=Math.abs(v-X)/c,Xe=E*r,qe=pe*pe;for(let q=Pe;q<$;q++){let me=Math.abs(Xe-q)/o,k=Math.sqrt(qe+me*me);if(k>=1)continue;M=2*k*k*k-3*k*k+1;let F=4*(q+X*t);le+=M*_[F+3],oe+=M,_[F+3]<255&&(M=M*_[F+3]/250),se+=M*_[F],ce+=M*_[F+1],he+=M*_[F+2],Y+=M}}I[R]=se/Y,I[R+1]=ce/Y,I[R+2]=he/Y,I[R+3]=le/oe}n.width=s,n.height=e,p.putImageData(u,0,0)}}function Ue(n,s){return n/100*s}var rt=(()=>{class n{crop(e,t,i,r,a){let o=this.getImagePosition(e,t,i,a),c=o.x2-o.x1,p=o.y2-o.y1,h=document.createElement("canvas");h.width=c,h.height=p;let u=h.getContext("2d");if(!u)return null;i.backgroundColor!=null&&(u.fillStyle=i.backgroundColor,u.fillRect(0,0,c,p));let _=(i.transform.scale||1)*(i.transform.flipH?-1:1),I=(i.transform.scale||1)*(i.transform.flipV?-1:1),{translateH:O,translateV:E}=this.getCanvasTranslate(e,i,a),R=e.transformed;u.setTransform(_,0,0,I,R.size.width/2+O,R.size.height/2+E),u.translate(-o.x1/_,-o.y1/I),u.rotate((i.transform.rotate||0)*Math.PI/180),u.drawImage(R.image,-R.size.width/2,-R.size.height/2);let v={width:c,height:p,imagePosition:o,cropperPosition:A({},t)};i.containWithinAspectRatio&&(v.offsetImagePosition=this.getOffsetImagePosition(e,t,i,a));let M=this.getResizeRatio(c,p,i);return M!==1&&(v.width=Math.round(c*M),v.height=i.maintainAspectRatio?Math.round(v.width/i.aspectRatio):Math.round(p*M),it(h,v.width,v.height)),r==="blob"?this.cropToBlob(v,h,i):(v.base64=h.toDataURL("image/"+i.format,this.getQuality(i)),v)}cropToBlob(e,t,i){return b(this,null,function*(){return e.blob=yield new Promise(r=>t.toBlob(r,"image/"+i.format,this.getQuality(i))),e.blob&&(e.objectUrl=URL.createObjectURL(e.blob)),e})}getCanvasTranslate(e,t,i){if(t.transform.translateUnit==="px"){let r=this.getRatio(e,i);return{translateH:(t.transform.translateH||0)*r,translateV:(t.transform.translateV||0)*r}}else return{translateH:t.transform.translateH?Ue(t.transform.translateH,e.transformed.size.width):0,translateV:t.transform.translateV?Ue(t.transform.translateV,e.transformed.size.height):0}}getRatio(e,t){return e.transformed.size.width/t.width}getImagePosition(e,t,i,r){let a=this.getRatio(e,r),o={x1:Math.round(t.x1*a),y1:Math.round(t.y1*a),x2:Math.round(t.x2*a),y2:Math.round(t.y2*a)};return i.containWithinAspectRatio||(o.x1=Math.max(o.x1,0),o.y1=Math.max(o.y1,0),o.x2=Math.min(o.x2,e.transformed.size.width),o.y2=Math.min(o.y2,e.transformed.size.height)),o}getOffsetImagePosition(e,t,i,r){let a=i.canvasRotation+e.exifTransform.rotate,o=this.getRatio(e,r),c,p;a%2?(c=(e.transformed.size.width-e.original.size.height)/2,p=(e.transformed.size.height-e.original.size.width)/2):(c=(e.transformed.size.width-e.original.size.width)/2,p=(e.transformed.size.height-e.original.size.height)/2);let h={x1:Math.round(t.x1*o)-c,y1:Math.round(t.y1*o)-p,x2:Math.round(t.x2*o)-c,y2:Math.round(t.y2*o)-p};return i.containWithinAspectRatio||(h.x1=Math.max(h.x1,0),h.y1=Math.max(h.y1,0),h.x2=Math.min(h.x2,e.transformed.size.width),h.y2=Math.min(h.y2,e.transformed.size.height)),h}getResizeRatio(e,t,i){let r=i.resizeToWidth/e,a=i.resizeToHeight/t,o=new Array;i.resizeToWidth>0&&o.push(r),i.resizeToHeight>0&&o.push(a);let c=o.length===0?1:Math.min(...o);return c>1&&!i.onlyScaleDown?c:Math.min(c,1)}getQuality(e){return Math.min(1,Math.max(0,e.imageQuality/100))}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=V({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),at=(()=>{class n{resetCropperPosition(e,t,i,r){if(e?.nativeElement)if(i.cropperStaticHeight&&i.cropperStaticWidth)t.x1=0,t.x2=r.width>i.cropperStaticWidth?i.cropperStaticWidth:r.width,t.y1=0,t.y2=r.height>i.cropperStaticHeight?i.cropperStaticHeight:r.height;else{let a=Math.min(i.cropperScaledMaxWidth,r.width),o=Math.min(i.cropperScaledMaxHeight,r.height);if(!i.maintainAspectRatio)t.x1=0,t.x2=a,t.y1=0,t.y2=o;else if(r.width/i.aspectRatio<r.height){t.x1=0,t.x2=a;let c=a/i.aspectRatio;t.y1=(r.height-c)/2,t.y2=t.y1+c}else{t.y1=0,t.y2=o;let c=o*i.aspectRatio;t.x1=(r.width-c)/2,t.x2=t.x1+c}}}move(e,t,i){let r=this.getClientX(e)-t.clientX,a=this.getClientY(e)-t.clientY;i.x1=t.x1+r,i.y1=t.y1+a,i.x2=t.x2+r,i.y2=t.y2+a}resize(e,t,i,r,a){let o=this.getClientX(e)-t.clientX,c=this.getClientY(e)-t.clientY;switch(t.position){case"left":i.x1=Math.min(Math.max(t.x1+o,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth);break;case"topleft":i.x1=Math.min(Math.max(t.x1+o,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"top":i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"topright":i.x2=Math.max(Math.min(t.x2+o,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth),i.y1=Math.min(Math.max(t.y1+c,i.y2-a.cropperScaledMaxHeight),i.y2-a.cropperScaledMinHeight);break;case"right":i.x2=Math.max(Math.min(t.x2+o,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth);break;case"bottomright":i.x2=Math.max(Math.min(t.x2+o,i.x1+a.cropperScaledMaxWidth),i.x1+a.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"bottom":i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"bottomleft":i.x1=Math.min(Math.max(t.x1+o,i.x2-a.cropperScaledMaxWidth),i.x2-a.cropperScaledMinWidth),i.y2=Math.max(Math.min(t.y2+c,i.y1+a.cropperScaledMaxHeight),i.y1+a.cropperScaledMinHeight);break;case"center":let p=e.scale,h=Math.min(Math.max(a.cropperScaledMinWidth,Math.abs(t.x2-t.x1)*p),a.cropperScaledMaxWidth),u=Math.min(Math.max(a.cropperScaledMinHeight,Math.abs(t.y2-t.y1)*p),a.cropperScaledMaxHeight);i.x1=t.clientX-h/2,i.x2=t.clientX+h/2,i.y1=t.clientY-u/2,i.y2=t.clientY+u/2,i.x1<0?(i.x2-=i.x1,i.x1=0):i.x2>r.width&&(i.x1-=i.x2-r.width,i.x2=r.width),i.y1<0?(i.y2-=i.y1,i.y1=0):i.y2>r.height&&(i.y1-=i.y2-r.height,i.y2=r.height);break}a.maintainAspectRatio&&this.checkAspectRatio(t.position,i,r,a)}checkAspectRatio(e,t,i,r){let a=0,o=0;switch(e){case"top":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,a=Math.max(t.x2-i.width,0),o=Math.max(0-t.y1,0),(a>0||o>0)&&(t.x2-=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y1+=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"bottom":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,a=Math.max(t.x2-i.width,0),o=Math.max(t.y2-i.height,0),(a>0||o>0)&&(t.x2-=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y2-=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"topleft":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,a=Math.max(0-t.x1,0),o=Math.max(0-t.y1,0),(a>0||o>0)&&(t.x1+=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y1+=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"topright":t.y1=t.y2-(t.x2-t.x1)/r.aspectRatio,a=Math.max(t.x2-i.width,0),o=Math.max(0-t.y1,0),(a>0||o>0)&&(t.x2-=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y1+=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"right":case"bottomright":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,a=Math.max(t.x2-i.width,0),o=Math.max(t.y2-i.height,0),(a>0||o>0)&&(t.x2-=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y2-=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"left":case"bottomleft":t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio,a=Math.max(0-t.x1,0),o=Math.max(t.y2-i.height,0),(a>0||o>0)&&(t.x1+=o*r.aspectRatio>a?o*r.aspectRatio:a,t.y2-=o*r.aspectRatio>a?o:a/r.aspectRatio);break;case"center":t.x2=t.x1+(t.y2-t.y1)*r.aspectRatio,t.y2=t.y1+(t.x2-t.x1)/r.aspectRatio;let c=Math.max(0-t.x1,0),p=Math.max(t.x2-i.width,0),h=Math.max(t.y2-i.height,0),u=Math.max(0-t.y1,0);(c>0||p>0||h>0||u>0)&&(t.x1+=h*r.aspectRatio>c?h*r.aspectRatio:c,t.x2-=u*r.aspectRatio>p?u*r.aspectRatio:p,t.y1+=u*r.aspectRatio>p?u:p/r.aspectRatio,t.y2-=h*r.aspectRatio>c?h:c/r.aspectRatio);break}}getClientX(e){return e.touches?.[0].clientX||e.clientX||0}getClientY(e){return e.touches?.[0].clientY||e.clientY||0}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=V({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),nt="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==";function ot(){return new Promise(n=>{let s=new Image;s.onload=()=>{let e=s.width===1&&s.height===2;n(e)},s.src=nt})}function st(n){switch(typeof n=="object"&&(n=ct(n)),n){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}function ct(n){let s=new DataView(n);if(s.getUint16(0,!1)!==65496)return-2;let e=s.byteLength,t=2;for(;t<e;){if(s.getUint16(t+2,!1)<=8)return-1;let i=s.getUint16(t,!1);if(t+=2,i==65505){if(s.getUint32(t+=2,!1)!==1165519206)return-1;let r=s.getUint16(t+=6,!1)==18761;t+=s.getUint32(t+4,r);let a=s.getUint16(t,r);t+=2;for(let o=0;o<a;o++)if(s.getUint16(t+o*12,r)==274)return s.getUint16(t+o*12+8,r)}else{if((i&65280)!==65280)break;t+=s.getUint16(t,!1)}}return-1}var ht=(()=>{class n{constructor(){this.autoRotateSupported=ot()}loadImageFile(e,t){return b(this,null,function*(){let i=yield e.arrayBuffer();return yield this.checkImageTypeAndLoadImageFromArrayBuffer(i,e.type,t)})}checkImageTypeAndLoadImageFromArrayBuffer(e,t,i){return this.isValidImageType(t)?this.loadImageFromArrayBuffer(e,i,t):Promise.reject(new Error("Invalid image type"))}isValidImageType(e){return/image\/(png|jpg|jpeg|bmp|gif|tiff|svg|webp|x-icon|vnd.microsoft.icon)/.test(e)}loadImageFromURL(e,t){return b(this,null,function*(){let r=yield(yield fetch(e)).blob(),a=yield r.arrayBuffer();return yield this.loadImageFromArrayBuffer(a,t,r.type)})}loadBase64Image(e,t){let i=this.base64ToArrayBuffer(e);return this.loadImageFromArrayBuffer(i,t)}base64ToArrayBuffer(e){e=e.replace(/^data:([^;]+);base64,/gmi,"");let t=atob(e),i=t.length,r=new Uint8Array(i);for(let a=0;a<i;a++)r[a]=t.charCodeAt(a);return r.buffer}loadImageFromArrayBuffer(e,t,i){return b(this,null,function*(){let r=yield new Promise((a,o)=>b(this,null,function*(){try{let c=new Blob([e],i?{type:i}:void 0),p=URL.createObjectURL(c),h=new Image,_=i==="image/svg+xml"?yield this.getSvgImageSize(c):void 0;h.onload=()=>a({originalImage:h,originalImageSize:_,originalObjectUrl:p,originalArrayBuffer:e}),h.onerror=o,h.src=p}catch(c){o(c)}}));return yield this.transformImageFromArrayBuffer(r,t,r.originalImageSize!=null)})}getSvgImageSize(e){return b(this,null,function*(){let r=new DOMParser().parseFromString(yield e.text(),"image/svg+xml").querySelector("svg");if(!r)throw Error("Failed to parse SVG image");let a=r.getAttribute("width"),o=r.getAttribute("height");if(a&&o)return null;let c=r.getAttribute("viewBox")||r.getAttribute("viewbox");if(c){let p=c.split(" ");return{width:+p[2],height:+p[3]}}throw Error("Failed to load SVG image. SVG must have width + height or viewBox definition.")})}transformImageFromArrayBuffer(e,t,i=!1){return b(this,null,function*(){let r=yield this.autoRotateSupported,a=st(r?-1:e.originalArrayBuffer);if(!e.originalImage||!e.originalImage.complete)return Promise.reject(new Error("No image loaded"));let o={original:{objectUrl:e.originalObjectUrl,image:e.originalImage,size:e.originalImageSize??{width:e.originalImage.naturalWidth,height:e.originalImage.naturalHeight}},exifTransform:a};return this.transformLoadedImage(o,t,i)})}transformLoadedImage(e,t,i=!1){return b(this,null,function*(){let r=t.canvasRotation+e.exifTransform.rotate,a=e.original.size;if(!i&&r===0&&!e.exifTransform.flip&&!t.containWithinAspectRatio)return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:A({},a)},transformed:{objectUrl:e.original.objectUrl,image:e.original.image,size:A({},a)},exifTransform:e.exifTransform};let o=this.getTransformedSize(a,e.exifTransform,t),c=document.createElement("canvas");c.width=o.width,c.height=o.height;let p=c.getContext("2d");p?.setTransform(e.exifTransform.flip?-1:1,0,0,1,c.width/2,c.height/2),p?.rotate(Math.PI*(r/2)),p?.drawImage(e.original.image,-a.width/2,-a.height/2);let h=yield new Promise(I=>c.toBlob(I,t.format));if(!h)throw new Error("Failed to get Blob for transformed image.");let u=URL.createObjectURL(h),_=yield this.loadImageFromObjectUrl(u);return{original:{objectUrl:e.original.objectUrl,image:e.original.image,size:A({},a)},transformed:{objectUrl:u,image:_,size:{width:_.width,height:_.height}},exifTransform:e.exifTransform}})}loadImageFromObjectUrl(e){return new Promise((t,i)=>{let r=new Image;r.onload=()=>t(r),r.onerror=i,r.src=e})}getTransformedSize(e,t,i){let r=i.canvasRotation+t.rotate;if(i.containWithinAspectRatio)if(r%2){let a=e.width*i.aspectRatio,o=e.height/i.aspectRatio;return{width:Math.max(e.height,a),height:Math.max(e.width,o)}}else{let a=e.height*i.aspectRatio,o=e.width/i.aspectRatio;return{width:Math.max(e.width,a),height:Math.max(e.height,o)}}return r%2?{height:e.width,width:e.height}:{width:e.width,height:e.height}}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=V({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Qe=(()=>{class n{constructor(e,t,i,r,a,o,c){this.cropService=e,this.cropperPositionService=t,this.loadImageService=i,this.sanitizer=r,this.cd=a,this.zone=o,this.hammerLoader=c,this.settings=new ae,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=y,this.imageVisible=!1,this.cropperFrameAriaLabel=this.settings.cropperFrameAriaLabel,this.output=this.settings.output,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new z,this.startCropImage=new z,this.imageLoaded=new z,this.cropperReady=new z,this.loadImageFailed=new z,this.transformChange=new z,this.reset()}ngOnChanges(e){this.onChangesUpdateSettings(e),this.onChangesInputImage(e),this.loadedImage?.original.image.complete&&(e.containWithinAspectRatio||e.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t)),(e.cropper||e.maintainAspectRatio||e.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.maintainAspectRatio&&(this.resetCropOnAspectRatioChange||!this.aspectRatioIsCorrect())&&(e.maintainAspectRatio||e.aspectRatio)?this.resetCropperPosition():e.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop())),e.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop()),e.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(e){this.settings.setOptionsFromChanges(e),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&(this.hideResizeSquares=!0,this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1}))}onChangesInputImage(e){(e.imageChangedEvent||e.imageURL||e.imageBase64||e.imageFile)&&this.reset(),e.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),e.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),e.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),e.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){let e=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${e}, ${this.transform.translateV||0}${e}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(e){this.loadImageService.loadImageFile(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadBase64Image(e){this.loadImageService.loadBase64Image(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}loadImageFromURL(e){this.loadImageService.loadImageFromURL(e,this.settings).then(t=>this.setLoadedImage(t)).catch(t=>this.loadImageError(t))}setLoadedImage(e){this.loadedImage=e,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(e.transformed.objectUrl),this.cd.markForCheck()}loadImageError(e){console.error(e),this.loadImageFailed.emit()}imageLoadedInView(){this.loadedImage!=null&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit(A({},this.maxSize)),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){if(this.loadedImage)if(this.hidden)this.resizedWhileHidden=!0;else{let e=A({},this.maxSize);this.setMaxSize(),this.resizeCropperPosition(e),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()}}activatePinchGesture(){return b(this,null,function*(){yield this.hammerLoader?.();let e=window?.Hammer||null;if(e){let t=new e(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else Se()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")})}resizeCropperPosition(e){(e.width!==this.maxSize.width||e.height!==this.maxSize.height)&&(this.cropper.x1=this.cropper.x1*this.maxSize.width/e.width,this.cropper.x2=this.cropper.x2*this.maxSize.width/e.width,this.cropper.y1=this.cropper.y1*this.maxSize.height/e.height,this.cropper.y2=this.cropper.y2*this.maxSize.height/e.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings,this.maxSize),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(e){this.changeKeyboardStepSize(e),this.keyboardMoveCropper(e)}changeKeyboardStepSize(e){let t=+e.key;t>=1&&t<=9&&(this.settings.stepSize=t)}keyboardMoveCropper(e){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(e.key))return;let i=e.shiftKey?y.Resize:y.Move,r=e.altKey?et(e.key):Ze(e.key),a=tt(e.key,this.settings.stepSize);e.preventDefault(),e.stopPropagation(),this.startMove({clientX:0,clientY:0},i,r),this.handleMouseMove(a),this.handleMouseUp()}startMove(e,t,i=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===y.Pinch||t===y.Drag&&!this.allowMoveImage||(e.preventDefault&&e.preventDefault(),this.moveStart=A({active:!0,type:t,position:i,transform:A({},this.transform),clientX:this.cropperPositionService.getClientX(e),clientY:this.cropperPositionService.getClientY(e)},this.cropper),this.initMouseMove())}initMouseMove(){Z(j(document,"mousemove"),j(document,"touchmove")).pipe(fe(Z(j(document,"mouseup"),j(document,"touchend")).pipe(de()))).subscribe({next:e=>this.zone.run(()=>{this.handleMouseMove(e),this.cd.markForCheck()}),complete:()=>this.zone.run(()=>{this.handleMouseUp(),this.cd.markForCheck()})})}startPinch(e){this.safeImgDataUrl&&(e.preventDefault&&e.preventDefault(),this.moveStart=A({active:!0,type:y.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2},this.cropper))}handleMouseMove(e){if(this.moveStart.active){if(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===y.Move)this.cropperPositionService.move(e,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===y.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===y.Drag){let t=this.cropperPositionService.getClientX(e)-this.moveStart.clientX,i=this.cropperPositionService.getClientY(e)-this.moveStart.clientY;this.transform=ge(A({},this.transform),{translateH:(this.moveStart.transform?.translateH||0)+t,translateV:(this.moveStart.transform?.translateV||0)+i}),this.setCssTransform()}}}onPinch(e){this.moveStart.active&&(e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault(),this.moveStart.type===y.Pinch&&(this.cropperPositionService.resize(e,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.markForCheck())}setMaxSize(){if(this.sourceImage){let e=getComputedStyle(this.sourceImage.nativeElement);this.maxSize.width=parseFloat(e.width),this.maxSize.height=parseFloat(e.height),this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.maintainAspectRatio?this.settings.cropperScaledMinHeight=Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?this.settings.cropperScaledMinHeight=Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):this.settings.cropperScaledMinHeight=20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){let e=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/e:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/e:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(e=!1){this.cropper.x1<0&&(this.cropper.x2-=e?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=e?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=e?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=e?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}handleMouseUp(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===y.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(e=this.settings.output){if(this.loadedImage?.transformed?.image!=null){if(this.startCropImage.emit(),e==="blob")return this.cropToBlob();if(e==="base64")return this.cropToBase64()}return null}cropToBlob(){return new Promise((e,t)=>this.zone.run(()=>b(this,null,function*(){let i=yield this.cropService.crop(this.loadedImage,this.cropper,this.settings,"blob",this.maxSize);i?(this.imageCropped.emit(i),e(i)):t("Crop image failed")})))}cropToBase64(){let e=this.cropService.crop(this.loadedImage,this.cropper,this.settings,"base64",this.maxSize);return e?(this.imageCropped.emit(e),e):null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return n.\u0275fac=function(e){return new(e||n)(T(rt),T(at),T(ht),T(He),T(Re),T(Ce),T(Te,8))},n.\u0275cmp=W({type:n,selectors:[["image-cropper"]],viewQuery:function(e,t){if(e&1&&(te(Ne,7),te(Ke,5)),e&2){let i;ie(i=re())&&(t.wrapper=i.first),ie(i=re())&&(t.sourceImage=i.first)}},hostVars:6,hostBindings:function(e,t){e&1&&x("resize",function(){return t.onResize()},xe),e&2&&(D("text-align",t.alignImage),G("disabled",t.disabled)("ngx-ix-hidden",t.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",cropperFrameAriaLabel:"cropperFrameAriaLabel",output:"output",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},standalone:!1,features:[N],decls:5,vars:10,consts:[["wrapper",""],["sourceImage",""],["class","ngx-ic-source-image","role","presentation",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart","error",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],["role","presentation",1,"ngx-ic-source-image",3,"load","mousedown","touchstart","error","src"],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],["role","presentation",1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],["role","presentation",1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],["role","presentation",1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],["role","presentation",1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(e,t){e&1&&(d(0,"div",null,0),K(2,Ge,2,8,"img",2),w(3,"div",3),K(4,Je,3,16,"div",4),f()),e&2&&(D("background",t.imageVisible&&t.backgroundColor),C(2),S("ngIf",t.safeImgDataUrl),C(),D("width",t.maxSize.width,"px")("height",t.maxSize.height,"px")("margin-left",t.alignImage==="center"?t.marginLeft:null),C(),S("ngIf",t.imageVisible))},dependencies:[ze],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),n})(),De=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=_e({type:n}),n.\u0275inj=ue({imports:[[Ee]]}),n})();var Le=(()=>{let s=class s{imageCropped(t){this.croppedDataUrl=t.base64}};s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=W({type:s,selectors:[["app-file-cropper"]],decls:3,vars:5,consts:[["output","base64","format","png",3,"imageCropped","maintainAspectRatio","imageBase64","aspectRatio","cropperStaticWidth","cropperStaticHeight"],[1,"mt10",3,"click"]],template:function(i,r){i&1&&(d(0,"image-cropper",0),x("imageCropped",function(o){return r.imageCropped(o)}),f(),d(1,"wbutton",1),x("click",function(){return r.uploadImage(r.croppedDataUrl),r.close()}),L(2,"Cropper"),f()),i&2&&S("maintainAspectRatio",!0)("imageBase64",r.dataUrl)("aspectRatio",1)("cropperStaticWidth",r.width)("cropperStaticHeight",r.height)},dependencies:[De,Qe,We],encapsulation:2});let n=s;return n})();var je=(()=>{let s=class s{constructor(){this._file=B(Be),this._file.add({id:"formPhoto",resize:1920,cb:t=>{typeof t=="string"&&typeof this.setFile=="function"&&this.setFile(t)}}),this._file.add({id:"formPhotos",multiple:!0,resize:1920,cb:t=>{typeof t=="string"&&typeof this.setFile=="function"&&this.setFile(t)}})}};s.\u0275fac=function(i){return new(i||s)},s.\u0275prov=V({token:s,factory:s.\u0275fac,providedIn:"root"});let n=s;return n})();function pt(n,s){if(n&1&&(d(0,"h3"),L(1),f()),n&2){let e=l(2);C(),be(e.label)}}function mt(n,s){if(n&1){let e=H();d(0,"label",2)(1,"img",5),x("error",function(){m(e);let i=l(2);return g(i.force=i.err)}),f()()}if(n&2){let e=l(2);C(),S("src",(!(e.force||e.value||"").includes("assets/default.png")&&!(e.force||e.value||"").includes("https")?e.url:"")+(e.value||"/assets/default.png"),P)("ngStyle",e.imgStyle)}}function gt(n,s){n&1&&(d(0,"label",3),L(1,"Add"),f())}function dt(n,s){if(n&1){let e=H();d(0,"div",6),w(1,"img",7),d(2,"i",8),x("click",function(){let i=m(e).$index,r=l(3);return g(r.files.splice(i,1))}),L(3,"X"),f()()}if(n&2){let e=s.$implicit,t=l(3);C(),S("src",(!(t.force||t.value||"").includes("assets/default.png")&&!(t.force||t.value||"").includes("https")?t.url:"")+e,P)}}function ft(n,s){if(n&1&&(d(0,"div",4),we(1,dt,4,1,"div",6,Me),f()),n&2){let e=l(2);C(),ye(e.files)}}function ut(n,s){if(n&1){let e=H();d(0,"div",1),x("click",function(){m(e);let i=l();return g(i.set())}),U(1,pt,2,1,"h3"),U(2,mt,2,2,"label",2),U(3,gt,2,0,"label",3),U(4,ft,3,0,"div",4),f()}if(n&2){let e=l();S("ngClass",e.class),C(),Q(e.label?1:-1),C(),Q(e.multiple?-1:2),C(),Q(e.multiple?3:-1),C(),Q(e.multiple?4:-1)}}var Jt=(()=>{let s=class s{constructor(){this._modal=B(Ve),this._http=B(Fe),this._fs=B(je),this.url=ke.url,this.container="general",this.name="",this.err="",this.label="",this.class="",this.imgStyle={},this.multiple=!1,this.isPhoto=!1,this.isRound=!1,this.value=this.multiple?[]:"",this.update=new z,this.force=""}get files(){return this.value}ngOnInit(){if(!this.name&&!this.multiple&&this.value){let t=(this.value||"").split("/");this.name=t[t.length-1].split("?")[0]}}ngOnChanges(t){t.value&&(this.value=t.value.currentValue,this.force="")}set(){this._fs.setFile=t=>{this.width&&this.height?this._modal.show({uploadImage:this.uploadImage.bind(this),component:Le,width:this.width,height:this.height,dataUrl:t}):this.uploadImage(t)}}uploadImage(t){let i=(this.name||"").includes("logo.png")?"":this.name;this._http.post("/api/file/photo",{container:this.container,name:i,dataUrl:t},r=>{this.multiple?(this.value||(this.value=[]),this.value.push(r)):(this.name=r.split("/")[5].split("?")[0],this.value=r),this.update.emit(this.value)})}};s.\u0275fac=function(i){return new(i||s)},s.\u0275cmp=W({type:s,selectors:[["ngx-file"]],inputs:{container:"container",name:"name",err:"err",label:"label",class:"class",imgStyle:"imgStyle",multiple:"multiple",isPhoto:"isPhoto",isRound:"isRound",resize:"resize",width:"width",height:"height",value:"value"},outputs:{update:"update"},features:[N],decls:1,vars:1,consts:[[3,"ngClass"],[3,"click","ngClass"],["for","formPhoto"],["for","formPhotos",1,"file__add"],[1,"file__list"],["alt","Picture",1,"file__img",3,"error","src","ngStyle"],[1,"file__item"],["alt","Picture",1,"file__item-img",3,"src"],[1,"file__item-remove",3,"click"]],template:function(i,r){i&1&&U(0,ut,5,5,"div",0),i&2&&Q(r.isPhoto?0:-1)},dependencies:[Ie,Oe],styles:[".file__img[_ngcontent-%COMP%]{display:block;max-width:100%;height:auto;border-radius:var(--file-img-border-radius, 8px);cursor:pointer}.file__img.round[_ngcontent-%COMP%]{border-radius:50%}.file__add[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:var(--file-add-bg, #007bff);color:#fff;border-radius:4px;cursor:pointer;text-align:center;transition:background-color .3s ease}.file__add[_ngcontent-%COMP%]:hover{background-color:var(--file-add-bg-hover, #0056b3)}.file__list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px}.file__item[_ngcontent-%COMP%]{position:relative;display:inline-block}.file__item-img[_ngcontent-%COMP%]{display:block;width:100px;height:100px;object-fit:cover;border-radius:var(--file-item-border-radius, 4px);cursor:pointer}.file__item-remove[_ngcontent-%COMP%]{position:absolute;top:5px;right:5px;background-color:#f00c;color:#fff;border-radius:50%;width:20px;height:20px;text-align:center;line-height:20px;font-size:12px;cursor:pointer;transition:background-color .3s ease}.file__item-remove[_ngcontent-%COMP%]:hover{background-color:red}"]});let n=s;return n})();export{Jt as a};
