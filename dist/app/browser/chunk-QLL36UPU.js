import{a as V}from"./chunk-M6LR55RW.js";import{b as B,e as D}from"./chunk-YVFHGXCX.js";import{$a as M,Aa as E,D as k,F as a,I as n,J as b,K as x,M as v,Ma as j,Qa as T,S as o,T as l,U as c,V as S,Y as w,Z as p,_ as h,_a as P,bb as L,eb as U,gb as d,ha as y,hb as F,qb as N,r as I,rb as q,v as _,w as g}from"./chunk-3XFWX5VI.js";function W(t,e){if(t&1&&S(0,"img",9),t&2){let m=h();o("src",m.logo,k)}}function G(t,e){t&1&&S(0,"icon-spider")}function K(t,e){if(t&1){let m=w();l(0,"span",10),p("click",function(){_(m);let r=h();return g(r.userService.setMode("dark"))}),y(1," dark_mode "),c()}}function Q(t,e){if(t&1){let m=w();l(0,"span",10),p("click",function(){_(m);let r=h();return g(r.userService.setMode())}),y(1," light_mode "),c()}}var H=(()=>{let e=class e{constructor(i,r,s,f,R,z,A,J){this.userService=i,this.ui=r,this._alert=s,this._http=f,this._hash=R,this._router=z,this._form=A,this._translate=J,this.logo=d.sign.logo,this.form=this._form.getForm("sign",{formId:"sign",title:"Sign In / Sign Up",components:[{name:"Email",key:"email",focused:!0,required:!0,fields:[{name:"Placeholder",value:"Enter your email"},{name:"Label",value:"Email"}]},{name:"Password",key:"password",required:!0,fields:[{name:"Placeholder",value:"Enter your password"},{name:"Label",value:"Password"}]},{name:"Number",key:"resetPin",fields:[{name:"Placeholder",value:"Enter code from email"},{name:"Label",value:"code"}],hidden:!0},{name:"Button",fields:[{name:"Label",value:"Let's go"},{name:"Submit",value:!0},{name:"Click",value:()=>{this.submit()}}]}]}),this.user={email:d.sign.email,password:d.sign.password,resetPin:null},this._set=u=>{if(u){let C=u.token||"";C&&this._http.set("token",C),localStorage.setItem("waw_user",JSON.stringify(u)),this.userService.setUser(u),this.userService.get(),this._router.navigateByUrl("/profile")}else this._alert.error({text:"Something went wrong"})}}submit(){!this.form.components[2].hidden&&this.user.resetPin?this.save():this.user.email||this._alert.error({text:this._translate.translate("Sign.Enter your email")}),this.ui.valid(this.user.email)?this.user.password?(this._hash.set("email",this.user.email),this._http.post("/api/user/status",this.user,i=>{i.email&&i.pass?this.login():i.email?this.reset():this.sign()})):this._alert.error({text:this._translate.translate("Sign.Enter your password")}):this._alert.error({text:this._translate.translate("Sign.Enter proper email")})}login(){this._http.post("/api/user/login",this.user,this._set.bind(this))}sign(){this._http.post("/api/user/sign",this.user,this._set.bind(this))}reset(){this._http.post("/api/user/request",this.user,()=>{this.form.components[2].hidden=!1}),this._alert.info({text:"Mail will sent to your email"})}save(){this._http.post("/api/user/change",this.user,i=>{i?this._alert.info({text:"Password successfully changed"}):this._alert.error({text:"Wrong Code"}),this.login()})}};e.\u0275fac=function(r){return new(r||e)(n(V),n(U),n(M),n(P),n(L),n(j),n(N),n(F))},e.\u0275cmp=b({type:e,selectors:[["ng-component"]],standalone:!1,decls:10,vars:6,consts:[[1,"auth-wrapper"],[1,"auth__wrap"],[1,"auth__img",3,"click"],["alt","Logo",3,"src",4,"ngIf"],[4,"ngIf"],[1,"auth__form"],[1,"auth"],["class","material-icons auth__icon",3,"click",4,"ngIf"],[3,"wSubmit","submition","config"],["alt","Logo",3,"src"],[1,"material-icons","auth__icon",3,"click"]],template:function(r,s){r&1&&(l(0,"div",0)(1,"div",1)(2,"div",2),p("click",function(){return s.userService.setMode(s.userService.mode?"":"dark")}),v(3,W,1,1,"img",3)(4,G,1,0,"icon-spider",4),c(),l(5,"div",5)(6,"div",6),v(7,K,2,0,"span",7)(8,Q,2,0,"span",7),l(9,"wform",8),p("wSubmit",function(){return s.submit()}),c()()()()()),r&2&&(a(3),o("ngIf",s.logo),a(),o("ngIf",!s.logo),a(3),o("ngIf",!s.userService.mode),a(),o("ngIf",s.userService.mode),a(),o("submition",s.user)("config",s.form))},dependencies:[E,q,B],encapsulation:2});let t=e;return t})();var X=[{path:"",component:H}],ce=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=x({type:e}),e.\u0275inj=I({imports:[T.forChild(X),D]});let t=e;return t})();export{ce as SignModule};
