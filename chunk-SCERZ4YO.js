import{a as D,b as E}from"./chunk-K5ATWWWY.js";import{c as W,d as P}from"./chunk-CZLGUVAL.js";import{a as V}from"./chunk-2H4XP5XP.js";import{c as F,e as I,f as M,h as A,j as L}from"./chunk-6F3JZZEN.js";import{$ as _,D as r,F as f,G as u,Ja as h,La as T,Na as w,Oa as x,Pa as S,U as d,ea as C,pa as g,qa as c,ra as p,sa as v,wa as b,xa as k,ya as y}from"./chunk-QGRJSNEC.js";function z(m,i){if(m&1&&h(0),m&2){let a=i.$implicit;T(" ",a.components==null?null:a.components.length," ")}}function B(m,i){if(m&1){let a=b();c(0,"label",3)(1,"input",4),k("ngModelChange",function(){let t=f(a).$implicit,o=y();return u(o.changeStatus(t))}),S("ngModelChange",function(t){let o=f(a).$implicit;return x(o.active,t)||(o.active=t),u(t)}),p(),v(2,"span",5),c(3,"span",6),h(4,"Active"),p()()}if(m&2){let a=i.$implicit;d(),w("ngModel",a.active)}}var Q=(()=>{let i=class i{constructor(){this._translate=r(V),this._cfs=r(W),this._alert=r(L),this._form=r(P),this.columns=["formId","components","active"],this.form=this._form.getForm("form",{formId:"form",title:"Custom form",components:[{name:"Text",key:"title",focused:!0,fields:[{name:"Placeholder",value:"fill title"},{name:"Label",value:"Title"}]},{name:"Select",key:"formId",fields:[{name:"Placeholder",value:"Select form id"},{name:"Label",value:"Form ID"},{name:"Items",value:this._form.formIds}]}]}),this.components=[],this.formComponents=this._form.getForm("formComponents",{formId:"formComponents",title:"Custom components",components:[{components:this.components},{name:"Select",key:"addComponent",fields:[{name:"Placeholder",value:"Select form componnet"},{name:"Label",value:"Form Component"},{name:"Value",value:"name",skipTranslation:!0},{name:"Items",value:this._form.getTemplateComponentsNames()}]}]}),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(e,t)=>{this._cfs.create(e,{callback:t.bind(this)})}}).then(this._cfs.create.bind(this))},update:e=>{this._form.modal(this.form,{label:"Update",click:(t,o)=>{this._cfs.update(t,{callback:o.bind(this)})}},e).then(this._cfs.update.bind(this))},delete:e=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this user?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._cfs.delete(e)}}]})},buttons:[{icon:"text_fields",click:e=>{console.log(this.formComponents),this.components.splice(0,this.components.length);let t={addComponent:"Text"};e.components=e.components||[];for(let n=e.components.length-1;n>=0;n--){let l=this._form.getTemplateFields(e.components[n].name);e.components[n].fields=e.components[n].fields.filter(s=>l.includes(s.name));for(let s of l)e.components[n].fields.find(N=>N.name===s)||e.components[n].fields.push({value:"",name:s});t["key"+n]=e.components[n].key;for(let s of e.components[n].fields)t[s.name+n]=s.value}let o=n=>{this.components.splice(n,1),e.components.splice(n,1),this._cfs.updateAfterWhile(e)};(e.components||[]).forEach(n=>{this.components.push(this._addCustomComponent(n.name,this.components.length,o))}),this._form.modal(this.formComponents,{label:"Add component",click:()=>{let n=t.addComponent;this.components.push(this._addCustomComponent(n,this.components.length,o)),e.components.push({name:t.addComponent,fields:this._form.getTemplateFields(n).map(l=>({value:"",name:l}))})}},t,()=>{},{size:"big"}).then(()=>{for(let n=0;n<e.components.length;n++){e.components[n].key=t["key"+n];for(let l of e.components[n].fields)l.value=t[l.name+n]}this._cfs.updateAfterWhile(e)})}}]}}get rows(){return this._cfs.customforms}_addCustomComponent(e,t,o){let n=this._form.getTemplateFields(e).map(s=>({name:this._form.getCustomTemplateFields(e)[s]||"Text",key:s+t,fields:[{name:"Placeholder",value:"fill "+s},{name:"Label",value:s.charAt(0).toUpperCase()+s.slice(1,s.length)}]}));return{class:"d-f mt10",components:[{name:"Text",key:"key"+t,fields:[{name:"Placeholder",value:"fill key"},{name:"Label",value:"Key"}]},...n,{name:"Button",fields:[{name:"Label",value:"Remove"},{name:"Click",value:()=>{o(t)}}]}]}}changeStatus(e){setTimeout(()=>{if(e.active)for(let t of this._cfs.customforms)t._id===e._id||t.formId!==e.formId||t.active&&(t.active=!1,this._cfs.updateAfterWhile(t));this._cfs.updateAfterWhile(e)})}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=_({type:i,selectors:[["ng-component"]],decls:3,vars:3,consts:[["title","Forms Customization",3,"columns","config","rows"],["cell","components"],["cell","active"],[1,"container-box"],["type","checkbox",1,"w-input__checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"checkmark-text"]],template:function(t,o){t&1&&(c(0,"wtable",0),C(1,z,1,1,"ng-template",1)(2,B,5,1,"ng-template",2),p()),t&2&&g("columns",o.columns)("config",o.config)("rows",o.rows)},dependencies:[E,D,A,F,I,M],encapsulation:2});let m=i;return m})();export{Q as a};
